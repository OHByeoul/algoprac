-- 루시와 엘라찾기
SELECT 
    ANIMAL_ID,
    NAME,
    SEX_UPON_INTAKE
FROM ANIMAL_INS
WHERE NAME IN ('Lucy','Ella','Pickle','Rogan','Sabrina','Mitty');


--- 이름에 el들어가는 동물찾기
-- 코드를 입력하세요
SELECT ANIMAL_ID, NAME
FROM ANIMAL_INS 
WHERE NAME LIKE '%EL%'
AND ANIMAL_TYPE = 'Dog'
ORDER BY NAME;

--중성화 여부 파악하기
SELECT ANIMAL_ID,
    NAME,
    CASE
        WHEN SEX_UPON_INTAKE LIKE '%Neutered%' THEN 'O'
        WHEN SEX_UPON_INTAKE LIKE '%Spayed%' THEN 'O'
        ELSE 'X'
    END AS RESULT
FROM ANIMAL_INS
ORDER BY ANIMAL_ID;
-------오랜기간 보호한 동물
-- 코드를 입력하세요
SELECT
TB.ANIMAL_ID,
    TB.NAME
FROM
(SELECT
    ROWNUM AS RN,
    TA.ANIMAL_ID,
    TA.NAME
FROM (SELECT
    AI.animal_id,
    AI.name,
    TO_CHAR(AO.DATETIME,'YYYYMMDD') - TO_CHAR(AI.DATETIME,'YYYYMMDD') AS DT
FROM ANIMAL_INS AI INNER JOIN ANIMAL_OUTS AO ON AI.ANIMAL_ID = AO.ANIMAL_ID
ORDER BY DT DESC) TA
WHERE ROWNUM <=2) TB