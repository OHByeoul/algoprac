/*
Enter your query here.
*/
SELECT
    ID
    ,T3.AGE
    ,T1.COIN
    ,T1.POWER
FROM
(SELECT CODE
    , MIN(COINS_NEEDED) AS COIN
    , POWER 
 FROM WANDS 
GROUP BY CODE, POWER) AS T1 
    INNER JOIN WANDS T2 ON T1.CODE = T2.CODE AND T1.POWER = T2.POWER AND T1.COIN = T2.COINS_NEEDED
    INNER JOIN Wands_Property T3 ON T1.CODE = T3.CODE
WHERE T3.IS_EVIL = 0
ORDER BY POWER DESC, AGE DESC